{% extends 'base_ventas.html' %}
{% load static %}
{% load staticfiles %}
{% load crispy_forms_tags %}
{% block title %}{{ "EC - Persona Jurídica" }}{% endblock title %}
{% block content %}
<div class="row">
		<h2 class="col-9 col-xl-9">Persona Jurídica</h2>
		<div class="col-3 col-xl-3">
			<a class="btn btn-secondary float-right" href="{% url 'juridicas_view' %}"><i class="fas fa-plus"></i> Agregar nuevo</a>
	</div>
</div>
<div class="campo ">
	<h5 class="campo consultas">Consultas</h5>
</div>
<div class="row">
	<div class="col-12 col-xl-12">
		<form method="get" id="forma_test" data-cities-url="{% url 'ajax_load_ciudades' %}" novalidate>
			{% csrf_token %}
			<h5>Información Empresa</h5>
			<div class="row">
				<div class="col-8 col-xl-8">
					{{ filter.form.nombre|as_crispy_field }}
				</div>
				<div class="col-4 col-xl-4">
					{{ filter.form.ruc|as_crispy_field }}
				</div>
			</div>
			<div class="row">
				<div class="col-5 col-xl-5">
					{{ filter.form.tipo_empresa|as_crispy_field }}
				</div>
				<div class="col-7 col-xl-7">
					{{ filter.form.sector|as_crispy_field }}
				</div>
			</div>
			<div class="row">

				<div class="col-2 col-xl-2">
					{{ filter.form.provincia|as_crispy_field }}
				</div>
				<div class="col-2 col-xl-2">
					{{ filter.form.ciudad|as_crispy_field }}
				</div>
				<div class="col-8 col-xl-8">
					{{ filter.form.direccion|as_crispy_field }}
				</div>
			</div>
			<div class="row">


				<div class="col-3 col-xl-3">
					{{ filter.form.telefono|as_crispy_field }}
				</div>
				<div class="col-3 col-xl-3">
					{{ filter.form.celular|as_crispy_field }}
				</div>
				<div class="col-3 col-xl-3">
					{{ filter.form.correo|as_crispy_field }}
				</div>
				<div class="col-3 col-xl-3">
					{{ filter.form.forma_pago|as_crispy_field }}
				</div>
			</div>
			<h5>Contacto empresa</h5>

			<div class="row">
				<div class="col-4 col-xl-4">
					{{ filter.form.contacto_cedula|as_crispy_field }}
				</div>
				<div class="col-4 col-xl-4">
					{{ filter.form.contacto_nombres|as_crispy_field }}
				</div>
				<div class="col-4 col-xl-4">
					{{ filter.form.contacto_apellidos|as_crispy_field }}
				</div>
			</div>
			<div class="row">


				<div class="col-4 col-xl-4">
					{{ filter.form.contacto_telefono|as_crispy_field }}
				</div>
				<div class="col-4 col-xl-4">
					{{ filter.form.contacto_celular|as_crispy_field }}
				</div>
				<div class="col-4 col-xl-4">
					{{ filter.form.contacto_correo|as_crispy_field }}
				</div>
			</div>
			
			<button  type="submit" class="btn btn-secondary float-right">
				<i class="fas fa-search"></i> Buscar</button>
			{{ filter.form.media }}
		</form>
		
	</div>
</div>

{% if juridicas %}
<div class="row">
	<div class="col-12 col-xl-12">
		{# Each "contact" is a Contact model object. #}
		<table class="table table-bordered">
			<thead class="thead-light">
				<tr>
					<th scope="col">RUC</th> 
					<th scope="col">Ciudad</th>
					<th scope="col">Provincia</th>
					<th scope="col">Tipo</th>
					<th scope="col">Sector</th>
					<th scope="col">Forma de pago</th>
					<th scope="col">Teléfono</th>
					<th scope="col">Celular</th>
					<th scope="col">Representante legal</th>
				</tr>
			</thead>
			<tbody>
				{% for j in juridicas %}
				<tr>
					<td scope="row">{{j.ruc}}</td> 
					<td scope="row">{{j.ciudad}}</td>
					<td scope="row">{{j.provincia}}</td>
					<td scope="row">{{j.tipo_empresa}}</td>
					<td scope="row">{{j.sector}}</td>
					<td scope="row">{{j.forma_pago}}</td>
					<td scope="row">{{j.telefono}}</td>
					<td scope="row">{{j.celular}}</td>
					<td scope="row">{{j.representante}}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>


{% else %}
<h2>No hay elementos que mostrar</h2>
{% endif %}
<ul class="pagination justify-content-center">
		{% if juridicas.has_previous %}
		
		<li class="page-item">

			<a class="page-link" href="?page={{ juridicas.previous_page_number }}">Anterior</a>
		</li>
		<li class="page-item">
			<a class="page-link" href="?page={{ juridicas.previous_page_number }}">{{ juridicas.previous_page_number }}</a>
		</li>

		{% else %}
			<li class="page-item disabled">
			<a class="page-link" tabindex="-1" href="#">Anterior</a>
		</li>
		{% endif %}

    
    <li class="page-item active">
    	<span class="page-link">
        {{ juridicas.number }}
        <span class="sr-only">(current)</span>
      </span>
    </li>

    {% if juridicas.has_next %}
    <li class="page-item">
			<a class="page-link" href="?page={{ juridicas.next_page_number }}">{{ juridicas.next_page_number }}</a>
		</li>
    	<li class="page-item">
			<a class="page-link" href="?page={{ juridicas.next_page_number }}">Siguiente</a>
		</li>
		
	
	{% else %}
		<li class="page-item disabled">
			<a class="page-link" tabindex="-1" href="#">Siguiente</a>
		</li>
	{% endif %}

  </ul>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
	$("#id_provincia").change(function () {
      var url = $("#forma_test").attr("data-cities-url");  // get the url of the `load_cities` view
      var countryId = $(this).val();  // get the selected country ID from the HTML input

      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          'provincia': countryId       // add the country id to the GET parameters
      },
        success: function (data) {   // `data` is the return of the `load_cities` view function
          $("#id_ciudad").html(data);  // replace the contents of the city input with the data that came from the server
      }
  });

  });
</script>
{% endblock %}